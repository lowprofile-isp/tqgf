(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-public-upgrade"],{"2ddc":function(e,t,a){"use strict";a("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.installApp=t.downloadApp=void 0,a("bf0f"),a("e966");t.downloadApp=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return new Promise((function(a,n){var o=plus.downloader.createDownload(e,{method:"GET"},(function(e,t){console.log(t,"status"),200==t?a(e.filename):(n("fail"),uni.showToast({title:"下载失败",duration:1500,icon:"none"}))}));o.addEventListener("statechanged",(function(e,a){switch(e.state){case 1:break;case 2:break;case 3:var n=e.totalSize&&e.totalSize>0;if(n){var o=parseInt(100*e.downloadedSize/e.totalSize);t(o)}break;case 4:break}})),o.start()}))};t.installApp=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};n(t),plus.runtime.install(plus.io.convertLocalFileSystemURL(e),{},(function(){}),(function(e){uni.showToast({title:"安装失败",duration:1500,icon:"none"})}))};var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=plus.android.runtimeMainActivity(),a=plus.android.implements("io.dcloud.android.content.BroadcastReceiver",{onReceive:function(n,o){plus.android.importClass(o),t.unregisterReceiver(a),e()}}),n=plus.android.importClass("android.content.IntentFilter"),o=plus.android.importClass("android.content.Intent"),i=new n;i.addAction(o.ACTION_PACKAGE_ADDED),i.addDataScheme("package"),t.registerReceiver(a,i)}},"50c2":function(e,t,a){var n=a("c86c");t=n(!1),t.push([e.i,"uni-page-body[data-v-8a8b0a1a]{background:rgba(0,0,0,.5)\n\t/**设置窗口背景半透明*/}body.?%PAGE?%[data-v-8a8b0a1a]{background:rgba(0,0,0,.5)}",""]),e.exports=t},"5c2d":function(e,t,a){"use strict";a.r(t);var n=a("fa06"),o=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=o.a},"8a3f":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"upgrade-popup"},[n("v-uni-image",{staticClass:"header-bg",attrs:{src:a("c90d"),mode:"widthFix"}}),n("v-uni-view",{staticClass:"main"},[n("v-uni-view",{staticClass:"version"},[e._v(e._s(e.versionInfo.versionTitle||"版本更新"))]),n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"desc",domProps:{innerHTML:e._s(e.versionInfo.versionDesc)}})],1),e.isStartDownload?n("v-uni-view",{staticClass:"footer"},[n("v-uni-view",{staticClass:"progress-view",class:{active:!e.hasProgress},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleInstallApp.apply(void 0,arguments)}}},[e.hasProgress?n("v-uni-view",{staticStyle:{height:"100%"}},[n("v-uni-view",{staticClass:"txt"},[e._v(e._s(e.percentText))]),n("v-uni-view",{staticClass:"progress",style:e.setProStyle})],1):n("v-uni-view",[n("v-uni-view",{staticClass:"btn upgrade force"},[e._v(e._s(e.isDownloadFinish?"立即安装":"下载中..."))])],1)],1)],1):e.versionInfo.isForceUpdate?n("v-uni-view",{staticClass:"footer"},[n("v-uni-view",{staticClass:"btn upgrade force",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleUpgrade.apply(void 0,arguments)}}},[e._v("立即更新")])],1):n("v-uni-view",{staticClass:"footer"},[n("v-uni-view",{staticClass:"btn close",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleClose.apply(void 0,arguments)}}},[e._v("以后再说")]),n("v-uni-view",{staticClass:"btn upgrade",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleUpgrade.apply(void 0,arguments)}}},[e._v("立即更新")])],1)],1)],1)},o=[]},"94bf":function(e,t,a){"use strict";a.r(t);var n=a("8a3f"),o=a("5c2d");for(var i in o)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(i);a("eb95"),a("d2dd");var r=a("828b"),s=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"8a8b0a1a",null,!1,n["a"],void 0);t["default"]=s.exports},a33e:function(e,t,a){var n=a("db9f");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=a("967d").default;o("0c465ba0",n,!0,{sourceMap:!1,shadowMode:!1})},c90d:function(e,t,a){e.exports=a.p+"static/images/upgrade/upgrade_bg.png"},d2dd:function(e,t,a){"use strict";var n=a("a33e"),o=a.n(n);o.a},db9f:function(e,t,a){var n=a("c86c");t=n(!1),t.push([e.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 行为相关颜色 */[data-v-8a8b0a1a]:export{baseColor:#6190e8;primary_color:#6190e8;uni_bg:#fff;uni_bg_dark:#12183d;uni_bg_dark_light:#262b54}.upgrade-popup[data-v-8a8b0a1a]{width:%?580?%;height:auto;position:fixed;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);background:#fff;border-radius:%?20?%;box-sizing:border-box;border:1px solid #eee}.header-bg[data-v-8a8b0a1a]{width:100%;margin-top:%?-112?%}.main[data-v-8a8b0a1a]{padding:%?10?% %?44?% %?30?%;box-sizing:border-box}.main .version[data-v-8a8b0a1a]{font-size:%?36?%;color:#026df7;font-weight:700;width:100%;text-align:center;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;letter-spacing:1px}.main .content[data-v-8a8b0a1a]{margin-top:%?40?%}.main .content .title[data-v-8a8b0a1a]{font-size:%?28?%;font-weight:700;color:#000}.main .content .desc[data-v-8a8b0a1a]{box-sizing:border-box;font-size:%?28?%;color:#000;max-height:80vh;overflow-y:auto}.main .footer[data-v-8a8b0a1a]{width:100%;display:flex;justify-content:center;align-items:center;position:relative;flex-shrink:0;margin-top:%?100?%}.main .footer .btn[data-v-8a8b0a1a]{width:%?246?%;display:flex;justify-content:center;align-items:center;position:relative;z-index:999;height:%?96?%;box-sizing:border-box;font-size:%?32?%;border-radius:%?10?%;letter-spacing:%?2?%}.main .footer .btn.force[data-v-8a8b0a1a]{width:%?500?%}.main .footer .btn.close[data-v-8a8b0a1a]{border:1px solid #e0e0e0;margin-right:%?25?%;color:#000}.main .footer .btn.upgrade[data-v-8a8b0a1a]{background-color:#026df7;color:#fff}.main .footer .progress-view[data-v-8a8b0a1a]{width:%?510?%;height:%?90?%;display:flex;position:relative;align-items:center;border-radius:%?6?%;background-color:#dcdcdc;display:flex;justify-content:flex-start;padding:0;box-sizing:border-box;border:none;overflow:hidden}.main .footer .progress-view.active[data-v-8a8b0a1a]{background-color:#026df7}.main .footer .progress-view .progress[data-v-8a8b0a1a]{height:100%;background-color:#026df7;padding:0;box-sizing:border-box;border:none;border-top-left-radius:%?10?%;border-bottom-left-radius:%?10?%}.main .footer .progress-view .txt[data-v-8a8b0a1a]{font-size:%?28?%;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);color:#fff}',""]),e.exports=t},eb95:function(e,t,a){"use strict";var n=a("f2473"),o=a.n(n);o.a},f2473:function(e,t,a){var n=a("50c2");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=a("967d").default;o("0f3670bc",n,!0,{sourceMap:!1,shadowMode:!1})},fa06:function(e,t,a){"use strict";a("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a("2ddc"),o={data:function(){return{isDownloadFinish:!1,hasProgress:!1,currentPercent:0,isStartDownload:!1,fileName:""}},computed:{versionInfo:function(){return this.$mStore.state.versionInfo},setProStyle:function(){return{width:510*this.currentPercent/100+"rpx"}},percentText:function(){var e=this.currentPercent;return"number"!==typeof e||isNaN(e)?"下载中...":e<100?"下载中".concat(e,"%"):"立即安装"}},onLoad:function(){},onBackPress:function(e){if("backbutton"==e.from)return!0},methods:{handleUpgrade:function(){var e=this;this.versionInfo.downloadUrl?(this.isStartDownload=!0,(0,n.downloadApp)(this.versionInfo.downloadUrl,(function(t){e.hasProgress=!0,e.currentPercent=t})).then((function(t){uni.getStorageSync("rememberPsw")||(uni.removeStorageSync("HCuname"),uni.removeStorageSync("HCpassw")),uni.removeStorageSync("currentUser"),uni.removeStorageSync("userName"),uni.removeStorageSync("tabbar"),uni.removeStorageSync("auths"),uni.removeStorageSync("userAuth"),uni.removeStorageSync("rememberPsw"),uni.removeStorageSync("initAuths"),e.isDownloadFinish=!0,e.fileName=t,t&&e.handleInstallApp()})).catch((function(e){console.log(e,"e")}))):uni.showToast({title:"下载链接不存在",icon:"none"})},handleInstallApp:function(){this.isDownloadFinish&&this.fileName&&(0,n.installApp)(this.fileName,(function(){uni.navigateBack()}))},handleClose:function(){uni.navigateBack()}}};t.default=o}}]);